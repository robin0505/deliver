# 微信小程序云开发环境配置指南

本文档提供了如何为这个校园跑腿小程序配置云开发环境的详细步骤。

## 当前云环境ID

您当前的云环境ID是：`delivers-env-5g2o7c84d90c5436`

此ID已经在app.js中配置好了，无需再次手动更改。如果您需要使用其他云环境，请按照下面的步骤操作。

## 1. 创建云开发环境

1. 打开微信开发者工具，点击左侧工具栏中的**云开发**按钮
2. 如果你是第一次使用云开发，会看到一个开通页面，点击"开通"
3. 填写环境名称，如"campus-delivery"，点击"创建"
4. 等待环境创建完成

## 2. 获取云环境ID

1. 在云开发控制台中，可以看到环境ID，它看起来类似这样：`cloud1-8g51v34o57c6a8a9`
2. 复制此ID，我们需要将它配置到小程序中

## 3. 在小程序中配置云环境ID

1. 打开 `miniprogram/app.js` 文件
2. 找到以下代码段：
```javascript
// 初始化云环境配置 - 您的云环境ID
const envId = 'delivers-env-5g2o7c84d90c5436';
```
3. 将 `delivers-env-5g2o7c84d90c5436` 替换为你在第2步复制的环境ID
4. 保存文件

## 4. 创建数据库集合

在云开发环境中，需要创建以下集合：

1. `users` - 存储用户信息
2. `orders` - 存储订单信息
3. `config` - 存储全局配置

对于每个集合，请按照以下步骤：

1. 在云开发控制台中，点击"数据库"
2. 点击"添加集合"，输入集合名称（如"users"）
3. 设置集合权限为"自定义"
4. 添加下列访问规则：
```json
{
  "read": true,
  "write": true
}
```
5. 点击"确认"完成创建

## 5. 部署云函数

本程序需要以下云函数：

- `login` - 处理用户登录
- `getUserData` - 获取用户数据
- `getOrderList` - 获取订单列表
- `getOngoingOrders` - 获取进行中的订单
- `createOrder` - 创建新订单
- `cancelOrder` - 取消订单
- `acceptOrder` - 接单
- `deliverOrder` - 标记送达
- `completeOrder` - 完成订单
- `getConfig` - 获取全局配置

对于每个云函数，请在创建后在云开发控制台中部署。

## 6. 测试云环境

配置完成后，请重新编译运行小程序，检查云环境是否正常工作。如果一切正常，你应该能够：

1. 成功登录小程序
2. 查看订单列表
3. 创建新订单
4. 执行其他云相关功能

## 7. 故障排除

如果遇到云环境相关问题：

1. **云函数调用失败** - 检查云函数是否正确部署，环境ID是否正确
2. **数据库操作失败** - 检查集合是否创建，权限是否设置正确
3. **云环境ID错误** - 重新检查app.js中配置的环境ID是否与云开发控制台显示的一致

## 8. 开发环境下的测试

在开发环境中，如果没有配置云环境ID或配置不正确：

1. 会显示提示信息建议配置云环境
2. 应用会使用模拟数据，以便你可以在不配置云环境的情况下进行UI开发
3. 但云相关功能（如创建真实订单）将无法使用

请确保在测试完整功能前正确配置云环境。 